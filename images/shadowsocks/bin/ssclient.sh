#!/bin/sh

SERVER_ADDR=${SHADOWSOCKS_REMOTE%:*}
SERVER_PORT=${SHADOWSOCKS_REMOTE#*:}

CLIENT_ADDR=${SHADOWSOCKS_LISTEN%:*}
CLIENT_PORT=${SHADOWSOCKS_LISTEN#*:}

ENCRYPT_METHOD=${SHADOWSOCKS_ENCRYPT_METHOD}
ENCRYPT_PASSWD=${SHADOWSOCKS_ENCRYPT_PASSWD}

TIMEOUT=${SHADOWSOCKS_TIMEOUT}

exec ss-local -s ${SERVER_ADDR} \
              -p ${SERVER_PORT} \
              -b ${CLIENT_ADDR} \
              -l ${CLIENT_PORT} \
              -k ${ENCRYPT_PASSWD} \
              -m ${ENCRYPT_METHOD} \
              -t ${TIMEOUT}
